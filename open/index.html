<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>JOMC News | World Updates, Hot Headlines, Breaking Stories</title>
    <meta name="description" content="JOMC News brings real time world news. Fast reliable and student powered.">
    <meta name="keywords" content="JOMC News, World news, News Site Kenya news, student journalism, Moi University news, Joseph Owino news">
    <meta name="author" content="JOMC News Team">
    <link rel="canonical" href="https://jomc-news.vercel.app/">
    <link rel="icon" href="/assets/images/logo.jpg" type="image/x-icon">
  <link rel="shortcut-icon" href="/assets/images/logo.jpg" type="image/x-icon">
    <!-- OpenGraph -->
    <meta property="og:title" content="JOMC News">
    <meta property="og:description" content="Real time World news.">
    <meta property="og:image" content="https://jomc-news.vercel.app/assets/images/logo.jpg">
    <meta property="og:url" content="https://jomc-news.vercel.app/">
    <meta property="og:type" content="website">
  
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="JOMC News">
    <meta name="twitter:description" content="Real time world news.">
    <meta name="twitter:image" content="https://jomc-news.vercel.app/assets/images/logo.jpg">
  
    <!-- Fonts and Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet" preconnect>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">
  
    <!-- Ads -->
    <!-- <script async data-cfasync="false" src="//pl28003297.effectivegatecpm.com/53af17ddb9e4b799586ecb86dc439eb2/invoke.js" defer></script>
    <script async data-cfasync="false" src="//pl28005774.effectivegatecpm.com/83706ba541e98f9c09f46db018571cf6/invoke.js" defer></script>
    <script async data-cfasync="false" src="//pl28010045.effectivegatecpm.com/545445584d06c09fd1a832fa75e54619/invoke.js" defer></script> -->
  
    <!-- Service Worker -->
    <script>
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("/sw.js")
          .then(() => console.log("SW Registered âœ…"))
          .catch(err => console.log("SW fail ðŸ’€", err));
      }
    </script>
  
    <!-- JS -->
    <script src="/assets/js/loader.js"></script>
    <script src="/assets/js/main.js" defer></script>
    <script src="/assets/js/utils.js"></script>
  
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/loader.css">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/dark.css">
  
    <!-- JSON LD -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "NewsMediaOrganization",
      "name": "JOMC News",
      "url": "https://jomc-news.vercel.app",
      "logo": {
        "@type": "ImageObject",
        "url": "https://jomc-news.vercel.app/assets/images/logo.jpg"
      },
      "description": "Digital news site with world updates",
      "sameAs": [
        "https://www.instagram.com/",
        "https://twitter.com/",
        "https://www.tiktok.com/"
      ]
    }
    </script>
  </head>
  <style>
    .action{
    font-size: 1.8em;
    max-width: fit-content;
    cursor: pointer;
    &:active{
        scale: 0.95;
    }
}
.-news{
    display: flex;
    flex-direction: column;
    padding: 10px;
    max-width: 600px;
}

iframe{
  max-width: 600px;
}
.actions{
    display: flex;
    gap: 20px;
    margin: 20px 0;
    a:nth-of-type(1){
      color: rgb(29, 181, 3);
    }
    a:nth-of-type(2){
      color: rgb(2, 112, 255);
    }
    a:nth-of-type(3){
      color: rgb(0, 0, 0);
    }
    a:nth-of-type(4){
      color: rgb(255, 2, 247);
    }
    a:nth-of-type(5){
      color: rgb(2, 255, 32);
    }
}
.filters{
    display: flex;
    gap: 20px;
    position: relative;
}
.filters>div{
    padding: 10px;
    cursor: pointer;
    position: relative;
    background: red;
    color: white;
    height: fit-content;
    flex-grow: none !important;
    &:hover{
        text-decoration: underline;
    }
}
.-n-title{
    font-size: 1.3em;
    font-family: 'Times New Roman', Times, serif;
    font-weight: 500;
    margin: 20px 0;
}
.date{
    color: rgba(101, 100, 100, 0.566);
    font-family: Verdana, Geneva, Tahoma, sans-serif;
    letter-spacing: 0.3;
    word-spacing: 0.8;

}
#news-content{
    font-family: 'Times New Roman', Times, serif;
    line-height: 1.8;
    font-weight: 500;
}
.news-img{
    display: flex;
    width: 97%;
    max-width: 500px;

}
.caption{
    color: rgba(128, 128, 128, 0.744);
    font-family:Arial, Helvetica, sans-serif;
    font-size: small;
    font-weight: 400;
    margin: 10px 0;
}
#stop{
    width: fit-content;
    padding: 2px;
}
.none{
  display: none !important;
}
.seen{
  display: flex !important;
}
.content iframe{
  width: 100%;
  height: 100%;
  min-width: 300px;
  max-height: 500px;
  object-fit: cover;
  flex-grow: 1;
}
  .content{
    display: flex;
    flex-wrap: nowrap;
  }
  #news-content{
      width: 100% !important;
      max-width: none !important;
    }
    .more .-news{
      /* background: red; */
      border-bottom: 1px solid #eee;
      display: flex;
      flex-direction: row !important;
      justify-content: start;
      align-items: start;
    }
  
    @media (max-width:500px) {
      .more .-news{
        flex-direction: column !important;
        img{
          width: 100%;
          max-width: none !important;
          object-fit: cover;
          max-height: 200px;
        }
      }
    }
  

  @media (max-width:768px) {
    .content{
      flex-wrap: wrap !important;
    }

    .rAd{
      width: 100% !important;
      max-width: none !important;
    }
    
  }
  .newsDivL{
    width: 80%;
    min-width: 350px;
    flex-grow: 1;
  }
  .rAd{
    width: fit-content;
    max-width: 600px;
    max-width: 20%;
  }
  .more{
    display: flex;
    flex-direction: column;
    flex-grow: 1;
    padding: 5px;
    min-width: 300px;
  }
  .article-text{
    padding: 10px;
  }
  .article-text img{
    max-width: 98% !important;
  }
  .-news .image{
    img{
      object-fit: cover;

    }
  }
  .art-actions{
    margin: 20px auto;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    display: flex;
    gap: 10px;
    .a-tags{
      display: flex;
    padding: 10px;

      gap: 10px;
      flex-wrap: wrap;
    }
  }
  .tag{
    padding: 5px 10px;
    background: rgba(255, 0, 0, 0.562);
    color: rgb(0, 0, 0);
    width: fit-content;
    cursor: pointer;
    user-select: none;
    *{
    text-transform: capitalize !important;
    }
    &:active{
      scale: 0.97;

    }
    i{
      color: black;
    }
    &:hover{
      background: green;
      color: white;
      i{
        color: white;
      }
    }
  }
  .news-wrapper .skeleton{
    background: rgba(128, 128, 128, 0.189);
    display: flex;
    flex-direction: column;
    border-radius: 10px;
    min-height: 0 !important;
    justify-content: start !important;
    align-items: start !important;
    margin: 0;

  }
  .art-img{
    display: flex;
    border-radius: 10px;
    height: 200px;
  }
  .bg-00{
    background: #0000 !important;
    padding: 0 !important;
  }
  .art-links{
    width: 50%;
    align-self: flex-start;

  }
  .row{
    flex-direction: row !important;
  }
  .art-content {
    >div:nth-child(4){
      width: 50%;
    }
    >div:nth-child(6){
      width: 50%;
    }
    >div:nth-child(7){
      width: 100%;
    }
    >div:nth-child(1){
      width: 98%;
    }
    >div:nth-child(3){
      width: 80%;
    }
  }
  .more{
    flex-grow: 1;
    width: 100%;
     .skeleton{
    flex-grow: 1;
    width: 100%;
  }
}
    .comment{
      background: rgba(128, 0, 122, 0.03);
      padding: 10px;
      border-bottom: 1px solid #c3c3c347;
    }
    .comment .comment-actions{
      display: flex;
      gap: 10px;
      .action{
        font-size: 1.2em;
        &:hoveR{
          color: rgb(0, 255, 0);
        }
      }

    }
    .comment-img img{
      width: 50px;
      border: 1px solid #333;
      border-radius: 50%;
      padding: 3px;
      aspect-ratio: 1;
    }
    .loginBtn{
      padding: 10px;
    background: #03d003;
    color: white;
    border: 0;
    }
    #openActions{
      position: absolute;
    right: 10px;
    top:10px;
    }
  </style>

<body>

  <div class="overlay">
    <div class="loader"></div>
  </div>
  <header class="header">
    <div class="l090-ic">
      <div class="logo-name">
        <a href="/" style="text-decoration: none;">
          <img src="/assets/images/logo.jpg" width="70">
        </a>
      </div>
      <style>

      </style>

      <div class="searchDiv none">
        <button class="closeSearch">&times;</button>
        <input type="search" name="query" id="query" placeholder="Enter your query">
        <button type="button" id="searchBtn">
          <i class="fas fa-search"></i>
        </button>
      </div>
      <div class="icons">
        <div class="modes">
          <i class="fas fa-moon"></i>
        </div>
        <div class="help">
          <i class="fas fa-info-circle"></i>
        </div>
        <div class="search">
          <i class="fas fa-search"></i>
        </div>
        <div class="menu-icon">
            <span></span>
            <span></span>
            <span></span>
        </div>
      </div>
    </div>
    <hr>
    <div class="links" >
      <a href="/">All News</a>
      <a href="/people">People</a>
      <a href="/entertainment">Entertainment</a>
      <a href="/health">Health</a>
      <a href="/climate">Climate</a>
      <a href="/politics">Politics</a>
      <a href="/business">Business</a>
      <a href="/sports">Sports</a>
      <a href="/world">World</a>
    </div>
  </header>

<div id="container-6adad3404bda5547a35f0dfe778b4446"></div>
  <div class="content">
    <div class="newsDivL">
      <div class="news-wrapper">
        <div class="skeleton bg-00">
        <div class="skeleton art-title"></div>
        <div class="skeleton art-links bg-00 row">
          <div class="skeleton"></div>
          <div class="skeleton"></div>
          <div class="skeleton"></div>
          <div class="skeleton"></div>
          <div class="skeleton"></div>
        </div>
        <div class="skeleton art-img"></div>
        <div class="skeleton art-content bg-00">
          <div class="skeleton content-lines"></div>
          <div class="skeleton content-lines"></div>
          <div class="skeleton content-lines"></div>
          <div class="skeleton content-lines"></div>
          <div class="skeleton content-lines"></div>
          <div class="skeleton content-lines"></div>
          <div class="skeleton content-lines"></div>
          <div class="skeleton content-lines"></div>
        </div>
        <div class="skeleton tags"></div>
        </div>
      </div>
      <div class="art-actions" style="flex-direction: column;">
        <div class="tags">
          <h3>Similar Tags</h3>
          <div class="a-tags">
            
          </div>
          <style>
            .comment, .comment-actions{
              position: relative;
              width:100%;
              min-width: 200px;
            }
            .comment-title{
              display: flex;
              gap: 10px;
            }
            .name{
              font-weight: 500;
              font-size: large;
            }
            .handle{
              text-underline-offset: 3px;
             a{
              color: rgba(0, 170, 255, 0.759)
            }
            }
            .comment-text{
              margin: 10px 0;
            }
            .comment .actions{
              background: rgb(223, 232, 223);
              flex-direction: column;
              padding: 10px;
              border: 1px solid rgba(0, 0, 0, 0.27);
              border-radius: 10px;
              font-size: small;
              gap: 0;
              position: absolute;
              top: 10px;
              right: 20px;
              box-shadow: 2px 5px 3px rgba(0, 0, 0, 0.338);
              z-index: 300000;
            }
           .inner{
              display: flex !important;
              flex-direction: row !important;
              width: fit-content;
              flex-grow: 1;
              gap: 5px;
            }

            .comment .actions>div{
              padding:3px 10px;
              margin: 0 !important;
              flex-grow: 1;
              cursor: pointer;
              justify-content: center;
              align-items: center;
              i{
              font-size: 2em;
              }
              &:hover{
                border: 0;
                background: rgba(61, 58, 58, 0.285);
                color: white;
              }
            }
            .count{
              font-size: small;
              color: rgb(167, 1, 1);
              text-align: center;
            }
            #add-comment{
              padding:10px;
              background: rgb(0, 255, 110);
              color: #000;
              text-decoration: none;
              margin: 10px 0 ;
              display: flex;
              justify-content: center;
              max-width: fit-content;
              border: 0;
              align-items: center;
              
            }
            .add-comment{
              margin: 10px 0;
              display: flex;
              gap: 10px ;
              flex-direction: column;
            }
            #comment-input{
              display: flex;
              border-radius: 5px;
              padding: 10px;
              font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
              outline: none;
              border: 1px solid #44444455;
              resize: vertical;
              max-height: 10em;
              min-height: 4em;
              margin: 10px 0;
              &::-webkit-scrollbar{
                display: none;
              }
              &:focus{
                border: 2px solid rgba(0, 174, 255, 0.534);
              }
            }
            .progress{
              width: fit-content;
              height: fit-content;
              position: absolute;
              left: 0px;
              bottom: 0;
              min-width: 100%;
              min-height: 10px;
              flex-grow: 1;
              display: flex;
              transition: all 0.5s ease-in-out;
             }
             .send{
              padding: 10px;
              border: 1px solid #605656;
              width: fit-content;
              position: absolute;
              right: 5px;
              bottom: 13px;
              border-radius: 50%;
              width: 40px;
              display: flex;
              justify-content: center;
              align-items: center;
              aspect-ratio: 1;
              &:hover{
                background: rgb(0, 217, 255);
              }
             }
             :disabled{
              background: grey;
              pointer-events: none;
              cursor: not-allowed;
             }

          </style>
        </div>
        <div class="cmdiv">

        <div class="add-comment">
          <div class="status" style="margin: 20px 0;">
          <b>Logged In as <span id="status" style="color: lightblue;"><a href="/account"> Lutan </a></span></b>
        </div>
        <div style="width: 100%; display: flex; flex-direction: column; gap: 10px; position: relative;">
          <button title="Add a comment" id="add-comment">Add a comment</button>
          <textarea rows="6" type="text" name="comment" id="comment-input" maxLength="500" placeholder="Type your comment here"></textarea>
          <button class="send">Send</button>
          <progress title="Word Count" class="progress" value="0" max="100">  </progress>
        </div>
          <script>
           
          </script>
        </div>
        <h2 style="margin: 10px 0;">Comments</h2>
        <hr style="margin: 10px 0;">

        <div class="comments" id="comments">
          </div>
          </div>
          </div>
          </div>
  <div class="more">
    <div class="skeleton news">
      <div class="image"></div>
      <div class="details">
        <div class="title"></div>
        <div class="context">
          <div class="c-line"></div>
          <div class="c-line"></div>
          <div class="c-line"></div>
          <div class="c-line"></div>
        </div>
      </div>
    </div>
    <div class="skeleton news">
      <div class="image"></div>
      <div class="details">
        <div class="title"></div>
        <div class="context">
          <div class="c-line"></div>
          <div class="c-line"></div>
          <div class="c-line"></div>
          <div class="c-line"></div>
        </div>
      </div>
    </div>
    <div class="skeleton news">
      <div class="image"></div>
      <div class="details">
        <div class="title"></div>
        <div class="context">
          <div class="c-line"></div>
          <div class="c-line"></div>
          <div class="c-line"></div>
          <div class="c-line"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="rAd">
    <script async="async" data-cfasync="false" src="//pl28003396.effectivegatecpm.com/007fd972b8495182decb806571941725/invoke.js"></script>
    <div id="container-007fd972b8495182decb806571941725"></div>
  </div>
</div>

  <script>

  const params = new URLSearchParams(window.location.search)
  const slug = params.get('s')
  if (slug) {
    // showLoader('Getting latest news...', 'info', 'clear')
    fetch(`${baseUrl}/get/${slug}`)
      .then(res => res.json())
      .then(data => {
        if (data.error) {
          alert(data.error, 'error')
        } else {

          const n = data.news
          const div = document.createElement('div')
          document.querySelector('.news-wrapper').innerHTML = ''
          div.innerHTML = 
          `
          <div class="news">
      <div class="filters">
        <div class="f">${n.categ}</div>
        <div class="f">${n.sub}</div>
      </div>
      <div class="-n-title">
        ${n.title}
      </div>
      <hr>
      <div class="date" style="margin-top: 20px;">
        ${formatTimehD(n.added)}
        </div>
      <div class="actions">
      <a href="#copyLink" id="copyLink">
        <div class="action" tooltip="Copy Link">
          <i class="fas fa-link"></i>
        </div>
      </a>

      <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=${window.location.origin}/open/?s=${n.slug}">
        <div class="action" tooltip="Share to Facebook">
          <i class="fab fa-facebook"></i>
        </div>
      </a>

      <a target="_blank" href="https://twitter.com/intent/tweet?url=${window.location.origin}/open/?s=${n.slug}">
        <div class="action" tooltip="Share to X">
          <i class="fab fa-x-twitter"></i>
        </div>
      </a>

      <a target="_blank" href="https://www.instagram.com/?url=${window.location.origin}/open/?s=${n.slug}">
        <div class="action" tooltip="Share to Instagram">
          <i class="fab fa-instagram"></i>
          </div>
        </a>

        <a target="_blank" 
            href="https://wa.me/send/?text=Check Out this news article by ${n.user ? n.user : 'Unknown'}%0A ${n.title} %0A${window.location.origin}/open/?s=${n.slug}" 
            tooltip="Share to WhatsApp">
            <div class="action" id="wa">
                <i class="fab fa-whatsapp"></i>
            </div>
          </a>

        <div class="action" onclick="speak()" id="listen" tooltip="Listen">
            <i class="fas fa-volume-down"></i>
        </div>
        <div class="playing none">
          <img src="https://i.ibb.co/QFB6FZXS/video-re-play-a2352f21.webp" alt="" style="pointer-events: none; user-select: none;">
        </div>
    
            
      </div>
      <div id="news-content">
        <img class="news-content-image" src="${n.image_url ? n.image_url : '/assets/images/logo.jpg'}">
        <div class="article-text">
        ${parseMarkdown(n.content)}
        </div>
</div>
      
        `
        window.n_id = n.id
        fetchComments(n.id)

//         // Copy link
div.querySelector('#copyLink').addEventListener('click', (e) => {
  e.preventDefault();
  const shareUrl = `${window.location.origin}/open/?s=${n.slug}`;
  navigator.clipboard.writeText(shareUrl).then(() => {
    alert('Link copied to clipboard', 'success');
  });
});
    document.querySelector('.news-wrapper').appendChild(div)
    const as = document.querySelectorAll('.links a')
    as.forEach(a=>{
      if(a.textContent.toLowerCase().trim() == n.categ.toLowerCase()){
        a.classList.add('active-page')
      }
    })


fetchTags(n.categ, n.sub)
 document.querySelector('title').innerText = `JOMC News : ${n.title}`
          hideLoader()
        }
      })
      .catch(err=>{
        showLoader('Failed to load page. Please Check your network connection', 'error', true)
      })
  }

   function fetchComments(id){
    fetch(`${baseUrl}/get_comments?id=${id}`)
    .then(res=>res.json())
    .then(data=>{
      if(data.error){
        alert(data.error, 'error')
      } else{
        const cs = data.comments.reverse()
        if(cs.length < 1){
          document.querySelector('.comments').innerHTML = 'No Comments yet';
          return
        }
        document.querySelector('.comments').innerHTML = '';
        
        cs.forEach(c=>{
          const div = document.createElement('div')
          div.classList.add('comment')
          div.innerHTML = `
              <div class="comment-title">
              <div class="comment-img">
                <img src="/assets/icons/tl.jpg" alt="">
              </div>
              <div class="comment-user">
                <div class="name">${c.user}</div>
                <div class="handle"><a href="/user/?u=${c.user}"> @${c.user}</a></div>
                <div class="action" id="openActions" tooltip="Actions">
                <i class="fas fa-ellipsis-v" style="font-size:small"></i>
              </div>
              <div class="actions none">
                <div class="copy-link" onclick="copy('${window.origin}/comment/?c=${c.id}')">Copy Link</div>
                <p>
                  <hr>
                </p>
          
                <div class="inner">
                  <a
                    href="https://wa.me/send/?text=${window.location.origin}/comment/?c=${c.id}" target="_blank">
                    <div class="share-action" tooltip="Share to whatsapp">
                      <i class="fab fa-whatsapp"></i>
                    </div>
                  </a>
                  <a href="https://www.facebook.com/sharer/sharer.php?u=${window.location.origin}/comment/?c=${c.id}" target="_blank">
                    <div class="share-action" title="share to facebook">
                      <i class="fab fa-facebook"></i>
                    </div>
                  </a>
                  <a href="https://twitter.com/intent/tweet?url=${window.location.origin}/comment/?c=${c.id}" target="_blank">
                    <div class="share-action" title="share to X">
                      <i class="fab fa-x-twitter"></i>
                    </div>
                  </a>
                  <a href="https://www.instagram.com/?url=${window.location.origin}/comment/?c=${c.id}" target="_blank">
                    <div class="share-action" title="share to instagram">
                      <i class="fab fa-instagram"></i>
                    </div>
                  </a>
                </div>
              </div>
              </div>
            </div>
            <div class="comment-text">
              ${parseMarkdown(c.content)}
            </div>
            <div class="comment-actions">
              <div class="action" tooltip="Like">
                <i class="fas fa-thumbs-up"></i>
                <div class="count">${c.likes || 0}</div>
              </div>
              <div class="action" tooltip="Dislike">
                <i class="fas fa-thumbs-down"></i>
                <div class="count">${c.dislikes || 0 }</div>
              </div>
              </div>
              
              
          
            </div>
          `
          document.querySelector('.comments').appendChild(div);
              const actions = div.querySelector('.comment .actions');
              const elip = div.querySelector('#openActions');

              if (elip && actions) {
                elip.addEventListener('click', (e) => {
                  e.stopPropagation();
                  actions.classList.toggle('none');
                  actions.classList.toggle('flex');
                });

                document.addEventListener('click', (e) => {
                  const clickedOutside =
                    !actions.contains(e.target) && !elip.contains(e.target);

                  if (clickedOutside && actions.classList.contains('flex')) {
                    actions.classList.add('none');
                    actions.classList.remove('flex');
                  }
                });
              }
        })
      }
    })

   }

  fetchLatestNews()

  function fetchLatestNews(){
    const lNews = document.querySelector('.more')
        showLoader('Updating page..', 'info', 'clear')
        fetch(`${baseUrl}/get_news?limit=16`)
        .then(res=>res.json())
        .then(data=>{
            if(data.error){
                showMessage(data.error, 'error')
            } else{
                const news = data.news
                lNews.innerHTML = ''

                if(news){
                    news.forEach(n => {
                        const div = document.createElement('div')
                        const a = document.createElement('a')     
                        a.setAttribute('href', `/open/?s=${n.slug}`)
                        a.classList.add('n-link')                   
                        div.classList.add('-news')
                        div.innerHTML = `
                        <div class="image" style="flex-grow:1"><img src="${n.image_url ? n.image_url : '/assets/images/logo.jpg'}" alt="" srcset="" width="200" style="max-width:none !important"></div>
                        <div class="details">
                            <div class="title"><b>
                               ${n.title}
                            </b></div>
                            <div class="context">
                                ${parseMarkdown(n.content)}...
                            </div>
                        </div>`
                        const previewText = safeText(n.content).slice(0, 20) + "..."
                         div.querySelector('.context').textContent = previewText

                        a.append(div)
                        lNews.appendChild(a)
                    });
                 hideLoader()
                }
            }
        })
    }

let synth = window.speechSynthesis;
let utter;
let isSpeaking = false;

function speak(){
const lbtn = document.querySelector('#listen');

  const text = document.querySelector('#news-content').textContent.trim();
  if (!text) return;

  // If already speaking, stop it
  if (isSpeaking) {
    synth.cancel();
    isSpeaking = false;
    lbtn.innerHTML = '<i class="fas fa-volume-down"></i>';
    document.querySelector('.playing').classList.add('none')
    document.querySelector('.playing').classList.remove('seen')
    return;
  }

  // Start speaking
  utter = new SpeechSynthesisUtterance(text);
  utter.rate = 1;
  utter.pitch = 6;
  utter.volume = 1;

  // Start icon vibes
  lbtn.innerHTML = '<i class="fas fa-stop"></i>'; // stop icon
  isSpeaking = true;
  document.querySelector('.playing').classList.add('seen')
  document.querySelector('.playing').classList.remove('none')

  synth.speak(utter);

  // When done, auto-reset icon
  utter.onend = () => {
    isSpeaking = false;
    lbtn.innerHTML = '<i class="fas fa-volume-down"></i>';
  document.querySelector('.playing').classList.add('none')
  document.querySelector('.playing').classList.remove('seen')


  };
};

function fetchTags(categ, sub){
  fetch(`${baseUrl}/get_tags?c=${categ}&s=${sub}`)
  .then(res=>res.json())
  .then(data=>{
    if(data.error){
      alert(data.error, 'error')
    }
    else if(data.tags){
      const at = document.querySelector('.a-tags')
      at.innerHTML = ''
       const ts = data.tags
       ts.forEach(t=>{
        const div = document.createElement('div')
        div.classList.add('tag')
        div.innerHTML = `<i class="fas fa-tag"></i>
              <span>${t}</span>`
       
       at.appendChild(div)
      })
    }
  })
  .catch(err=>{
    alert(err.message, 'error')
  })
}

document.addEventListener('DOMContentLoaded',()=>{
             const draft = sessionStorage.getItem('draft')
              const co = document.querySelector('#comment-input')
              if(draft){
                co.value = draft
              }
              const send = document.querySelector('.send')
              co.addEventListener('input', (e)=>{
              var val = co.value.trim().length
              const p = document.querySelector('.progress')
              if(p){
                p.value = (parseInt(val) / 500) * 100
                alert(p.value)
              } 
              sessionStorage.setItem('draft', co.value.trim()

              )})
              co.addEventListener('keydown', (e)=>{
                if(e.key == 'Enter'){
                  e.preventDefault()
                   send.click()
                }
              })
              send.addEventListener('click', (e)=>{
                e.stopImmediatePropagation()
                if(co.value.trim() && co.value.trim() != ''){
                  sendComment(co.value.trim())
                } else{
                  alert('Please Enter Comment Text', 'error')
                  return
                }
              })
             
    function sendComment(val) {
              send.disabled = true;
              const uid = localStorage.getItem('uid');
              
              if (uid && window.n_id != '') {
                fetch(`${baseUrl}/comment`, {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json'
                  },
                  body: JSON.stringify({
                    content: val,
                    uid: uid,
                    c_id: window.n_id
                  })
                })
                  .then(res => res.json())
                  .then(data => {
                    if(data.error){
                    alert(data.error)
                    send.disabled = false;
                      return 
                    }
                    else{
                    alert(data.message);
                    send.disabled = false;
                    sessionStorage.removeItem('draft')
                    }
                  })
                  .catch(err => {
                    alert('Network Error: ' + err.message, 'error');
                    send.disabled = false;
                  });
              } else {
                alert('You are not Logged in. Please Login to comment', 'error');
                document.querySelector('.add-comment').innerHTML = `<button class="loginBtn" onclick="window.location.href='/login'"> Login to Comment</button>`
                send.disabled = false;
              }
            }

            })

        

            </script>
  <footer class="footer">
    <div class="footer-top">

      <div class="footer-brand">
        <h2>J.O News</h2>
        <p>Your daily plug for verified news and vibes.</p>
        <div class="socials">
          <a href="#"><i class="fab fa-facebook"></i></a>
          <a href="#"><i class="fab fa-x-twitter"></i></a>
          <a href="#"><i class="fab fa-instagram"></i></a>
          <a href="#"><i class="fab fa-youtube"></i></a>
        </div>
      </div>

      <div class="footer-links">
        <h3>Quick Links</h3>
        <a href="/">Home</a>
        <a href="/world">World</a>
        <a href="/business">Business</a>
        <a href="/sports">Sports</a>
        <a href="/entertainment">Entertainment</a>
      </div>

      <div class="footer-sub">
        <h3>Stay Updated</h3>
        <p>No spam, just hot headlines.</p>
        <form class="sub-form">
          <input type="email" placeholder="Enter your email">
          <button type="submit">Subscribe</button>
        </form>
      </div>

    </div>

    <div class="footer-bottom">
      <p>Â© 2025 J.O News. All rights reserved.</p>
    </div>
  </footer>

</body>


</html>